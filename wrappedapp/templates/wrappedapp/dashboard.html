{% extends 'wrappedapp/base.html' %}

{% block content %}
  <header class="dashboard-header">
    <div class="header-top">
      <h1>Your Top Tracks</h1>
      {% if user_name %}
        <p class="user-greeting">Logged in as <strong>{{ user_name }}</strong></p>
      {% endif %}
    </div>

    <div class="forms-container">
      <form action="{% url 'dashboard' %}" method="get" class="time-form">
        <label for="time_range">Time Range:</label>
        <select name="time_range" id="time_range" onchange="this.form.submit()">
          <option value="short_term" {% if range == 'short_term' %}selected{% endif %}>Last 4 Weeks</option>
          <option value="medium_term" {% if range == 'medium_term' %}selected{% endif %}>Last 6 Months</option>
          <option value="long_term" {% if range == 'long_term' %}selected{% endif %}>All Time</option>
        </select>
        <input type="hidden" name="limit" value="{{ limit }}">
      </form>

      <form action="{% url 'dashboard' %}" method="get" class="time-form">
        <label for="limit">Song Limit:</label>
        <select name="limit" id="limit" onchange="this.form.submit()">
          <option value="5" {% if limit == '5' %}selected{% endif %}>5</option>
          <option value="10" {% if limit == '10' %}selected{% endif %}>10</option>
          <option value="20" {% if limit == '20' %}selected{% endif %}>20</option>
        </select>
        <input type="hidden" name="time_range" value="{{ range }}">
      </form>
    </div>
  </header>

  <main class="tracks-container">
    {% if tracks %}
      {% for track in tracks %}
        <div class="track-card">
          <img src="{{ track.album.images.0.url }}" alt="{{ track.name }}" class="album-art">
          <div class="track-info">
            <h3>{{ track.name }}</h3>
            <p>{{ track.artists.0.name }}</p>
          </div>
        </div>
      {% endfor %}
    {% else %}
      <p class="no-tracks">No tracks found for this range.</p>
    {% endif %}
  </main>
{% endblock %}
